<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Map</title>
    <link rel="stylesheet" type="text/css" href="../web_test/main.css">
    <link rel="stylesheet" type="text/css" href="./map.css">
    <link rel="stylesheet" type="text/css" href="./popup.css">
    <link rel="stylesheet" href="https://unpkg.com/swiper/swiper-bundle.min.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://apis.openapi.sk.com/tmap/jsv2?version=1&appKey="></script>
    <script type="text/javascript" src="trip_list.js"></script>
    <script type="text/javascript" src="marker.js"></script>
    <script type="text/javascript" src="path.js"></script>
    <script>
        let map;
        let markers = []; // 마커
        let markerInOrder = []; // 선택한 여행지 순서로 된 마커 좌표값
        let popup = []; // 팝업
        let new_polyLine = [];
        let pointArray = [];
        let routeCheck = false; // 경로표시 여부 T/F

        $(document).ready(function(){
     

            // 맵 생성
            map = new Tmapv2.Map("map_div", {
                center : new Tmapv2.LatLng(37.88728485257855, 127.73813767661932),
                zoom : 15,
                zoomControl: false,
                scrollwheel: true
            });

            // 여행 데이터 불러오기
            $.ajax({
                url : "trip_data.json",
                type : "GET",
                dataType : "json",
                success: function(response){
                    const trip_data = response.data;

                    tripList(trip_data); // 여행지 리스트 생성하기
                    createMarker(trip_data); // 마커 생성하기
                },
                error: function(error){
                    alert("여행지 데이터를 불러오지 못 했습니다.");
                }
            });
        });

        // 구현중
        function search(){
          

          $.ajax({
                url : "trip_data.json",
                type : "GET",
                dataType : "json",
                success: function(response){
                    const trip_data = response.data;

                    searchCheck(trip_data);
                },
                error: function(error){
                    alert("여행지 데이터를 불러오지 못 했습니다.");
                }
          });
        }
        
        function searchCheck(data){
          const t_data = data;
          let v = document.getElementById("searchValue").value;
          let varr = [];

          for(let i=0; i<t_data.length; i++){
            let t = t_data[i];
            if(v === t.spot){
              alert(t.description);
              break;
            }  
          }
        }
    </script>
</head>
<body>
  <header>
    <div class="wrapper">
      <h1> LOGO </h1>
      <!--<img src="LOGO.png" width="5%", height="5%"> -->
      <ul class="menu">
        <li><a href="#">이달의 추천 여행지</a></li>
        <li><a href="#">나의 루트</a></li>
      </ul>
    </div>
  </header>
  <section>
    <div class="container">
      <div class="container_title">
        <!-- <span><span id="container_area">(선택한 여행지)</span>의 추천 관광지를 찾아봤어요</span> -->
        <span class="search">
          <input type="text" id="searchValue">
          <input type="button" value="검색" onclick="search()">
        </span>
        <!-- 수정 ↓ : <input type="button" value="경로 찾기"> -->
        <input type="button" id="draw_path" value="경로 안내" onclick="path()">
      </div>
      <div class="container_box">
        
        <!-- 여행지 list -->
        <div class="container_list" id="list"></div>
        <!-- 수정 : 관광지 리스트 html를 javascript에서 동적으로 생성 (tripList 함수 참고) -->
        
        <!-- 지도 -->
        <div class="container_map">
          <!-- 수정 ↓ : <img src="http://placehold.it/900x900"> -->
          <div id="map_div"></div>
        </div>
      </div>
    </div>
  </section>
  <footer>
    <div class="footer">
      <!-- 수정 ↓ : <p>copyright</p> -->
      <!-- 마커, 팝업 아이콘 출처 -->
      <div>
        [popup Icons made by <a href="https://www.freepik.com" title="Freepik">Freepik</a>
        / marker Icons made by <a href="https://www.flaticon.com/authors/vectors-market" title="Vectors Market">Vectors Market</a>]
        from <a href="https://www.flaticon.com/" title="Flaticon">www.flaticon.com</a>
      </div>
    </div>
  </footer>
</body>
</html>